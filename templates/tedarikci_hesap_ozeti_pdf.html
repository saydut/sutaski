<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>{{ rapor_basligi }}</title>
    <link rel="stylesheet" href="static/css/pdf_style.css">
    <style>
        .ozet-karti .deger.borc { color: #D9534F; }
        .ozet-karti .deger.alacak { color: #5CB85C; }
        .ozet-karti .deger.odeme { color: #F0AD4E; }
        .ozet-karti .deger.net { font-weight: bold; color: #0275D8; }
        .text-right { text-align: right; }
        .toplam-satir { background-color: #F1F5F9; font-weight: bold; }
        .islem-tipi-odeme { color: #5CB85C; }
        .islem-tipi-avans { color: #D9534F; }
    </style>
</head>
<body>
    <div class="rapor-container">
        <header class="rapor-baslik">
            <h1>{{ rapor_basligi }}</h1>
            <p>{{ sirket_adi }} | {{ tedarikci_adi }} | Rapor Oluşturma Tarihi: {{ olusturma_tarihi }}</p>
        </header>

        <section class="ozet-karti-container">
            <div class="ozet-karti">
                <div class="baslik">Toplam Süt Alacağı</div>
                <div class="deger alacak">{{ "%.2f"|format(ozet.toplam_sut_alacagi) }} TL</div>
            </div>
            <div class="ozet-karti">
                <div class="baslik">Toplam Yem Borcu</div>
                <div class="deger borc">{{ "%.2f"|format(ozet.toplam_yem_borcu) }} TL</div>
            </div>
            <div class="ozet-karti">
                <div class="baslik">Yapılan Toplam Ödeme</div>
                <div class="deger odeme">{{ "%.2f"|format(ozet.toplam_odeme) }} TL</div>
            </div>
            <div class="ozet-karti">
                <div class="baslik">Ödenecek Net Tutar</div>
                <div class="deger net">{{ "%.2f"|format(ozet.net_bakiye) }} TL</div>
            </div>
        </section>

        <h2>Süt Girdileri Dökümü</h2>
        <table>
            <thead>
                <tr>
                    <th>Tarih</th>
                    <th class="text-right">Litre</th>
                    <th class="text-right">Birim Fiyat</th>
                    <th class="text-right">Günlük Toplam</th>
                </tr>
            </thead>
            <tbody>
                {% for girdi in sut_girdileri %}
                <tr>
                    <td>{{ girdi.tarih }}</td>
                    <td class="text-right">{{ "%.2f"|format(girdi.litre) }} L</td>
                    <td class="text-right">{{ "%.2f"|format(girdi.fiyat) }} TL</td>
                    <td class="text-right">{{ "%.2f"|format(girdi.toplam_tutar) }} TL</td>
                </tr>
                {% else %}
                <tr><td colspan="4" style="text-align: center;">Bu ay için süt girdisi bulunamadı.</td></tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr class="toplam-satir">
                    <td colspan="3" class="text-right">Süt Alacağı Toplamı</td>
                    <td class="text-right">{{ "%.2f"|format(ozet.toplam_sut_alacagi) }} TL</td>
                </tr>
            </tfoot>
        </table>

        <h2>Yem Alımları Dökümü</h2>
        <table>
            <thead>
                <tr>
                    <th>Tarih</th>
                    <th>Ürün Adı</th>
                    <th class="text-right">Miktar (KG)</th>
                    <th class="text-end">Birim Fiyat</th>
                    <th class="text-right">Toplam Tutar</th>
                </tr>
            </thead>
            <tbody>
                {% for islem in yem_islemleri %}
                <tr>
                    <td>{{ islem.islem_tarihi }}</td>
                    <td>{{ islem.yem_adi }}</td>
                    <td class="text-right">{{ "%.2f"|format(islem.miktar_kg | float) }}</td>
                    <td class="text-end">{{ "%.2f"|format(islem.islem_anindaki_birim_fiyat | float) }} TL</td>
                    <td class="text-right">{{ "%.2f"|format(islem.toplam_tutar | float) }} TL</td>
                </tr>
                {% else %}
                <tr><td colspan="5" style="text-align: center;">Bu ay için yem alımı bulunamadı.</td></tr>
                {% endfor %}
            </tbody>
             <tfoot>
                <tr class="toplam-satir">
                    <td colspan="4" class="text-right">Yem Borcu Toplamı</td>
                    <td class="text-right">{{ "%.2f"|format(ozet.toplam_yem_borcu) }} TL</td>
                </tr>
            </tfoot>
        </table>

        <h2>Finansal İşlemler (Ödemeler/Avanslar)</h2>
        <table>
            <thead>
                <tr>
                    <th>Tarih</th>
                    <th>İşlem Tipi</th>
                    <th>Açıklama</th>
                    <th class="text-right">Tutar</th>
                </tr>
            </thead>
            <tbody>
                {% for islem in finansal_islemler %}
                <tr>
                    <td>{{ islem.islem_tarihi }}</td>
                    <td>
                        <span class="islem-tipi-{{ 'odeme' if islem.islem_tipi == 'Ödeme' else 'avans' }}">
                            {{ islem.islem_tipi }}
                        </span>
                    </td>
                    <td>{{ islem.aciklama or '-' }}</td>
                    <td class="text-right">{{ "%.2f"|format(islem.tutar | float) }} TL</td>
                </tr>
                {% else %}
                <tr><td colspan="4" style="text-align: center;">Bu ay için ödeme veya avans işlemi bulunamadı.</td></tr>
                {% endfor %}
            </tbody>
             <tfoot>
                <tr class="toplam-satir">
                    <td colspan="3" class="text-right">Yapılan Toplam Ödeme</td>
                    <td class="text-right">{{ "%.2f"|format(ozet.toplam_odeme) }} TL</td>
                </tr>
            </tfoot>
        </table>

        <footer class="rapor-altbilgi">Süt Takip Sistemi Tarafından Otomatik Olarak Oluşturulmuştur.</footer>
    </div>
</body>
</html>
